{
  "id": 1,
  "uid": "n8n-complete-monitoring",
  "title": "N8N Complete Monitoring - Production (App + Containers)",
  "tags": ["n8n", "monitoring", "kubernetes", "containers", "production"],
  "timezone": "browser",
  "schemaVersion": 36,
  "version": 1,
  "refresh": "30s",
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "panels": [
    {
      "id": 1,
      "type": "row",
      "title": "üìä N8N Application Metrics",
      "gridPos": {"x": 0, "y": 0, "w": 24, "h": 1}
    },
    {
      "id": 2,
      "type": "stat",
      "title": "üîÑ Workflows Ativos",
      "gridPos": {"x": 0, "y": 1, "w": 4, "h": 4},
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "red", "value": 0},
              {"color": "yellow", "value": 20},
              {"color": "green", "value": 25}
            ]
          }
        }
      },
      "targets": [
        {"expr": "n8n_active_workflow_count", "legendFormat": "Workflows"}
      ]
    },
    {
      "id": 3,
      "type": "stat",
      "title": "‚ö° Jobs na Fila",
      "gridPos": {"x": 4, "y": 1, "w": 4, "h": 4},
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 10},
              {"color": "red", "value": 50}
            ]
          }
        }
      },
      "targets": [
        {"expr": "n8n_scaling_mode_queue_jobs_waiting + n8n_scaling_mode_queue_jobs_active", "legendFormat": "Total Fila"}
      ]
    },
    {
      "id": 4,
      "type": "stat",
      "title": "‚úÖ Jobs Completados",
      "gridPos": {"x": 8, "y": 1, "w": 4, "h": 4},
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "value"},
          "mappings": [
            {"options": {"pattern": "*"}, "type": "special", "text": "‚úÖ"}
          ]
        }
      },
      "targets": [
        {"expr": "n8n_scaling_mode_queue_jobs_completed", "legendFormat": "Completados"}
      ]
    },
    {
      "id": 5,
      "type": "stat",
      "title": "‚ùå Jobs Falharam",
      "gridPos": {"x": 12, "y": 1, "w": 4, "h": 4},
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 5},
              {"color": "red", "value": 20}
            ]
          }
        }
      },
      "targets": [
        {"expr": "n8n_scaling_mode_queue_jobs_failed", "legendFormat": "Falhas"}
      ]
    },
    {
      "id": 6,
      "type": "stat",
      "title": "üîß Vers√£o N8N",
      "gridPos": {"x": 16, "y": 1, "w": 4, "h": 4},
      "fieldConfig": {
        "defaults": {}
      },
      "targets": [
        {"expr": "n8n_version_info", "legendFormat": "v{{version}}"}
      ]
    },
    {
      "id": 7,
      "type": "stat",
      "title": "‚è±Ô∏è Sistema Online",
      "gridPos": {"x": 20, "y": 1, "w": 4, "h": 4},
      "fieldConfig": {
        "defaults": {
          "unit": "dtdurations",
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "red", "value": 0},
              {"color": "green", "value": 1}
            ]
          }
        }
      },
      "targets": [
        {"expr": "time() - n8n_process_start_time_seconds", "legendFormat": "Uptime"}
      ]
    },
    {
      "id": 8,
      "type": "timeseries",
      "title": "üìà Throughput de Jobs (por minuto)",
      "gridPos": {"x": 0, "y": 5, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "palette-classic"}
        }
      },
      "targets": [
        {"expr": "rate(n8n_scaling_mode_queue_jobs_completed[1m]) * 60", "legendFormat": "‚úÖ Completados/min"},
        {"expr": "rate(n8n_scaling_mode_queue_jobs_failed[1m]) * 60", "legendFormat": "‚ùå Falhas/min"},
        {"expr": "n8n_scaling_mode_queue_jobs_active", "legendFormat": "üîÑ Ativos"},
        {"expr": "n8n_scaling_mode_queue_jobs_waiting", "legendFormat": "‚è≥ Esperando"}
      ]
    },
    {
      "id": 9,
      "type": "piechart",
      "title": "üéØ Distribui√ß√£o de Jobs (√öltima Hora)",
      "gridPos": {"x": 12, "y": 5, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {"unit": "short"}
      },
      "targets": [
        {"expr": "increase(n8n_scaling_mode_queue_jobs_completed[1h])", "legendFormat": "‚úÖ Completados"},
        {"expr": "increase(n8n_scaling_mode_queue_jobs_failed[1h])", "legendFormat": "‚ùå Falharam"},
        {"expr": "n8n_scaling_mode_queue_jobs_active", "legendFormat": "üîÑ Executando"},
        {"expr": "n8n_scaling_mode_queue_jobs_waiting", "legendFormat": "‚è≥ Na Fila"}
      ]
    },
    {
      "id": 10,
      "type": "row",
      "title": "üê≥ Container & Kubernetes Metrics",
      "gridPos": {"x": 0, "y": 13, "w": 24, "h": 1}
    },
    {
      "id": 11,
      "type": "timeseries",
      "title": "üî• CPU Usage - N8N Pods",
      "gridPos": {"x": 0, "y": 14, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "color": {"mode": "palette-classic"}
        }
      },
      "targets": [
        {"expr": "rate(container_cpu_usage_seconds_total{namespace=\"n8n\", pod=~\"n8n-.*\"}[5m]) * 100", "legendFormat": "{{pod}} CPU %"},
        {"expr": "rate(container_cpu_usage_seconds_total{namespace=\"n8n\", pod=~\"n8n-worker-.*\"}[5m]) * 100", "legendFormat": "{{pod}} CPU %"}
      ]
    },
    {
      "id": 12,
      "type": "timeseries",
      "title": "üíæ Memory Usage - N8N Pods",
      "gridPos": {"x": 12, "y": 14, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "decbytes",
          "color": {"mode": "palette-classic"}
        }
      },
      "targets": [
        {"expr": "container_memory_usage_bytes{namespace=\"n8n\", pod=~\"n8n-.*\"}", "legendFormat": "{{pod}} Memory"},
        {"expr": "container_memory_usage_bytes{namespace=\"n8n\", pod=~\"n8n-worker-.*\"}", "legendFormat": "{{pod}} Memory"}
      ]
    },
    {
      "id": 13,
      "type": "gauge",
      "title": "üìä CPU Utiliza√ß√£o por Pod",
      "gridPos": {"x": 0, "y": 22, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "thresholds": {
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 70},
              {"color": "red", "value": 85}
            ]
          }
        }
      },
      "targets": [
        {"expr": "rate(container_cpu_usage_seconds_total{namespace=\"n8n\", container!=\"POD\", container!=\"\"}[5m]) * 100", "legendFormat": "{{pod}} - {{container}}"}
      ]
    },
    {
      "id": 14,
      "type": "gauge",
      "title": "üß† Memory Utiliza√ß√£o por Pod",
      "gridPos": {"x": 12, "y": 22, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "thresholds": {
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 70},
              {"color": "red", "value": 85}
            ]
          }
        }
      },
      "targets": [
        {"expr": "(container_memory_usage_bytes{namespace=\"n8n\", container!=\"POD\", container!=\"\"} / container_spec_memory_limit_bytes{namespace=\"n8n\", container!=\"POD\", container!=\"\"}) * 100", "legendFormat": "{{pod}} - {{container}}"}
      ]
    },
    {
      "id": 15,
      "type": "row",
      "title": "‚ö° N8N Application Performance",
      "gridPos": {"x": 0, "y": 30, "w": 24, "h": 1}
    },
    {
      "id": 16,
      "type": "timeseries",
      "title": "üîÑ Event Loop Performance",
      "gridPos": {"x": 0, "y": 31, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "ms",
          "color": {"mode": "palette-classic"}
        }
      },
      "targets": [
        {"expr": "n8n_nodejs_eventloop_lag_p50_seconds * 1000", "legendFormat": "P50 (Mediana)"},
        {"expr": "n8n_nodejs_eventloop_lag_p90_seconds * 1000", "legendFormat": "P90"},
        {"expr": "n8n_nodejs_eventloop_lag_p99_seconds * 1000", "legendFormat": "P99"},
        {"expr": "n8n_nodejs_eventloop_lag_max_seconds * 1000", "legendFormat": "M√°ximo"}
      ]
    },
    {
      "id": 17,
      "type": "timeseries",
      "title": "üóëÔ∏è Garbage Collection",
      "gridPos": {"x": 12, "y": 31, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "ms",
          "color": {"mode": "palette-classic"}
        }
      },
      "targets": [
        {"expr": "rate(n8n_nodejs_gc_duration_seconds_sum{kind=\"minor\"}[5m]) / rate(n8n_nodejs_gc_duration_seconds_count{kind=\"minor\"}[5m]) * 1000", "legendFormat": "GC Minor"},
        {"expr": "rate(n8n_nodejs_gc_duration_seconds_sum{kind=\"major\"}[5m]) / rate(n8n_nodejs_gc_duration_seconds_count{kind=\"major\"}[5m]) * 1000", "legendFormat": "GC Major"},
        {"expr": "rate(n8n_nodejs_gc_duration_seconds_sum{kind=\"incremental\"}[5m]) / rate(n8n_nodejs_gc_duration_seconds_count{kind=\"incremental\"}[5m]) * 1000", "legendFormat": "GC Incremental"}
      ]
    },
    {
      "id": 18,
      "type": "timeseries",
      "title": "üíæ N8N Application Memory (Heap)",
      "gridPos": {"x": 0, "y": 39, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "decbytes",
          "color": {"mode": "palette-classic"}
        }
      },
      "targets": [
        {"expr": "n8n_nodejs_heap_size_used_bytes", "legendFormat": "Heap Usado"},
        {"expr": "n8n_nodejs_heap_size_total_bytes", "legendFormat": "Heap Total"},
        {"expr": "n8n_nodejs_external_memory_bytes", "legendFormat": "Mem√≥ria Externa"}
      ]
    },
    {
      "id": 19,
      "type": "bargauge",
      "title": "üìÇ Active Resources by Type",
      "gridPos": {"x": 12, "y": 39, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {"unit": "short"}
      },
      "targets": [
        {"expr": "n8n_nodejs_active_resources{type=\"Timeout\"}", "legendFormat": "‚è∞ Timeouts"},
        {"expr": "n8n_nodejs_active_resources{type=\"TCPSocketWrap\"}", "legendFormat": "üîå TCP Sockets"},
        {"expr": "n8n_nodejs_active_resources{type=\"TCPServerWrap\"}", "legendFormat": "üñ•Ô∏è TCP Servers"},
        {"expr": "n8n_nodejs_active_resources{type=\"PipeWrap\"}", "legendFormat": "üîó Pipes"},
        {"expr": "n8n_nodejs_active_resources{type=\"ProcessWrap\"}", "legendFormat": "‚öôÔ∏è Processos"}
      ]
    },
    {
      "id": 20,
      "type": "row",
      "title": "üö® Sistema e Alertas",
      "gridPos": {"x": 0, "y": 47, "w": 24, "h": 1}
    },
    {
      "id": 21,
      "type": "table",
      "title": "üìã Status dos Pods N8N",
      "gridPos": {"x": 0, "y": 48, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {"unit": "short"}
      },
      "targets": [
        {"expr": "up{job=\"kubernetes-pods\", kubernetes_namespace=\"n8n\"}", "legendFormat": "{{kubernetes_pod_name}}"}
      ]
    },
    {
      "id": 22,
      "type": "timeseries",
      "title": "üîÑ Pod Restarts & Status",
      "gridPos": {"x": 12, "y": 48, "w": 12, "h": 8},
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "palette-classic"}
        }
      },
      "targets": [
        {"expr": "kube_pod_container_status_restarts_total{namespace=\"n8n\"}", "legendFormat": "Restarts: {{pod}}"},
        {"expr": "kube_pod_status_phase{namespace=\"n8n\", phase=\"Running\"}", "legendFormat": "Running: {{pod}}"}
      ]
    }
  ]
}